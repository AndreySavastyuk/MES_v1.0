<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è–º–∏</title>
    <link rel="stylesheet" href="tasks-manager.css">
</head>
<body>
    <div class="app-container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <header class="header">
            <div class="header-content">
                <h1>üìã –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è–º–∏</h1>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="openCreateTaskModal()">
                        ‚ûï –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ
                    </button>
                    <button class="btn btn-warning" onclick="openImportModal()">
                        üìä –ò–º–ø–æ—Ä—Ç Excel
                    </button>
                    <button class="btn btn-primary" onclick="showAllItems()">
                        üì¶ –í—Å–µ –ø–æ–∑–∏—Ü–∏–∏
                    </button>
                    <button class="btn btn-warning" onclick="showReceiving()">
                        üì• –ü—Ä–∏–µ–º–∫–∞
                    </button>
                    <button class="btn btn-secondary" onclick="showArchive()">
                        üóÇÔ∏è –ê—Ä—Ö–∏–≤
                    </button>
                    <button class="btn btn-info" onclick="refreshTasks()">
                        üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
            </div>
        </header>

        <!-- –ü–∞–Ω–µ–ª—å –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
        <div class="search-panel">
            <button class="search-toggle-btn" onclick="toggleFilters()">
                üîç –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
            </button>
            <div class="filters-container" id="filtersContainer">
                <div class="filter-group">
                    <label>üìä –°—Ç–∞—Ç—É—Å:</label>
                    <select id="statusFilter" onchange="filterTasks()">
                        <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                        <option value="development">–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</option>
                        <option value="sent">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω</option>
                        <option value="loaded">–ó–∞–≥—Ä—É–∂–µ–Ω</option>
                        <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                        <option value="paused">–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</option>
                        <option value="completed">–í—ã–ø–æ–ª–Ω–µ–Ω</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>‚ö° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</label>
                    <select id="priorityFilter" onchange="filterTasks()">
                        <option value="">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
                        <option value="low">–ù–∏–∑–∫–∏–π</option>
                        <option value="normal">–ù–æ—Ä–º–∞–ª—å–Ω—ã–π</option>
                        <option value="important">–í–∞–∂–Ω—ã–π</option>
                        <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>üîç –ü–æ–∏—Å–∫:</label>
                    <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –Ω–æ–º–µ—Ä—É –∑–∞–¥–∞–Ω–∏—è –∏–ª–∏ –∑–∞–∫–∞–∑–∞..." onkeyup="filterTasks()">
                </div>
                <div class="filter-group">
                    <label>üìÖ –ü–µ—Ä–∏–æ–¥:</label>
                    <select id="periodFilter" onchange="filterTasks()">
                        <option value="">–í—Å–µ –≤—Ä–µ–º—è</option>
                        <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
                        <option value="week">–≠—Ç–∞ –Ω–µ–¥–µ–ª—è</option>
                        <option value="month">–≠—Ç–æ—Ç –º–µ—Å—è—Ü</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞–¥–∞–Ω–∏–π -->
        <div class="table-container">
            <table class="tasks-table" id="tasksTable">
                <thead>
                    <tr>
                        <th class="col-task-id sortable" data-sort="taskNumber" onclick="sortTable('taskNumber')">
                            ‚Ññ –ó–∞–¥–∞–Ω–∏—è <span class="sort-icon">‚ÜïÔ∏è</span>
                        </th>
                        <th class="col-order-id sortable" data-sort="orderNumber" onclick="sortTable('orderNumber')">
                            ‚Ññ –ó–∞–∫–∞–∑–∞ <span class="sort-icon">‚ÜïÔ∏è</span>
                        </th>
                        <th class="col-title sortable" data-sort="title" onclick="sortTable('title')">
                            –ù–∞–∑–≤–∞–Ω–∏–µ <span class="sort-icon">‚ÜïÔ∏è</span>
                        </th>
                        <th class="col-priority sortable" data-sort="priority" onclick="sortTable('priority')">
                            –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç <span class="sort-icon">‚ÜïÔ∏è</span>
                        </th>
                        <th class="col-status sortable" data-sort="status" onclick="sortTable('status')">
                            –°—Ç–∞—Ç—É—Å <span class="sort-icon">‚ÜïÔ∏è</span>
                        </th>
                        <th class="col-created sortable" data-sort="created" onclick="sortTable('created')">
                            –°–æ–∑–¥–∞–Ω <span class="sort-icon">‚ÜïÔ∏è</span>
                        </th>
                        <th class="col-updated sortable" data-sort="updated" onclick="sortTable('updated')">
                            –û–±–Ω–æ–≤–ª–µ–Ω <span class="sort-icon">‚ÜïÔ∏è</span>
                        </th>
                        <th class="col-progress sortable" data-sort="progress" onclick="sortTable('progress')">
                            –ü—Ä–æ–≥—Ä–µ—Å—Å <span class="sort-icon">‚ÜïÔ∏è</span>
                        </th>
                    </tr>
                </thead>
                <tbody id="tasksTableBody">
                    <!-- –ó–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </tbody>
            </table>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è -->
        <div id="createTaskModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚ûï –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è</h2>
                    <span class="close" onclick="closeModal('createTaskModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="createTaskForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>‚Ññ –ó–∞–¥–∞–Ω–∏—è</label>
                                <input type="text" id="taskNumber" readonly placeholder="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏...">
                            </div>
                            <div class="form-group">
                                <label>‚Ññ –ó–∞–∫–∞–∑–∞ *</label>
                                <input type="text" id="orderNumber" required placeholder="2024/001" pattern="[0-9]{4}/[0-9]{3}" title="–§–æ—Ä–º–∞—Ç: –ì–ì–ì–ì/–ß–ß–ß" maxlength="8" oninput="formatOrderNumber(this)">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è *</label>
                            <input type="text" id="taskTitle" required placeholder="–ö—Ä–∞—Ç–∫–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∑–∞–¥–∞–Ω–∏—è">
                        </div>
                        <div class="form-group">
                            <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea id="taskDescription" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                                <select id="taskPriority">
                                    <option value="normal">–ù–æ—Ä–º–∞–ª—å–Ω—ã–π</option>
                                    <option value="low">–ù–∏–∑–∫–∏–π</option>
                                    <option value="important">–í–∞–∂–Ω—ã–π</option>
                                    <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>–¢–∏–ø –∑–∞–¥–∞–Ω–∏—è</label>
                                <select id="taskType">
                                    <option value="inventory">–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è</option>
                                    <option value="receive">–ü—Ä–∏–µ–º–∫–∞</option>
                                    <option value="shipment">–û—Ç–≥—Ä—É–∑–∫–∞</option>
                                    <option value="move">–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>–ü–æ–∑–∏—Ü–∏–∏ –∑–∞–¥–∞–Ω–∏—è</label>
                            <div id="taskPositions">
                                <button type="button" class="btn btn-outline" onclick="addPosition()">
                                    ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('createTaskModal')">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-success" onclick="createTask()">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è -->
        <div id="editTaskModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</h2>
                    <span class="close" onclick="closeModal('editTaskModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="tabs">
                        <button class="tab-button active" onclick="openTab(event, 'editTab')">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
                        <button class="tab-button" onclick="openTab(event, 'historyTab')">–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π</button>
                        <button class="tab-button" onclick="openTab(event, 'progressTab')">–ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</button>
                    </div>
                    
                    <div id="editTab" class="tab-content active">
                        <form id="editTaskForm">
                            <input type="hidden" id="editTaskId">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>‚Ññ –ó–∞–¥–∞–Ω–∏—è</label>
                                    <input type="text" id="editTaskNumber" readonly>
                                </div>
                                <div class="form-group">
                                    <label>‚Ññ –ó–∞–∫–∞–∑–∞ *</label>
                                    <input type="text" id="editOrderNumber" required pattern="[0-9]{4}/[0-9]{3}" title="–§–æ—Ä–º–∞—Ç: –ì–ì–ì–ì/–ß–ß–ß">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è *</label>
                                <input type="text" id="editTaskTitle" required>
                            </div>
                            <div class="form-group">
                                <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                                <textarea id="editTaskDescription"></textarea>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                                    <select id="editTaskPriority">
                                        <option value="low">–ù–∏–∑–∫–∏–π</option>
                                        <option value="normal">–ù–æ—Ä–º–∞–ª—å–Ω—ã–π</option>
                                        <option value="important">–í–∞–∂–Ω—ã–π</option>
                                        <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>–°—Ç–∞—Ç—É—Å</label>
                                    <select id="editTaskStatus">
                                        <option value="development">–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</option>
                                        <option value="sent">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω</option>
                                        <option value="loaded">–ó–∞–≥—Ä—É–∂–µ–Ω</option>
                                        <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                        <option value="paused">–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</option>
                                        <option value="completed">–í—ã–ø–æ–ª–Ω–µ–Ω</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é</label>
                                <textarea id="editComment" placeholder="–û–ø–∏—à–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –∏–∑–º–µ–Ω–µ–Ω–∏—è"></textarea>
                            </div>
                        </form>
                    </div>
                    
                    <div id="historyTab" class="tab-content">
                        <div id="changeHistory">
                            <!-- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                    
                    <div id="progressTab" class="tab-content">
                        <div id="taskProgress">
                            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('editTaskModal')">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-info" onclick="openTaskReport(document.getElementById('editTaskId').value)">üìä –û—Ç—á–µ—Ç</button>
                    <button class="btn btn-warning" onclick="sendToTablet()">üì± –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç</button>
                    <button class="btn btn-danger" onclick="deleteTask(document.getElementById('editTaskId').value); closeModal('editTaskModal')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    <button class="btn btn-success" onclick="saveTask()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–º–ø–æ—Ä—Ç–∞ Excel -->
        <div id="importModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2>üìä –ò–º–ø–æ—Ä—Ç Excel —Ñ–∞–π–ª–∞</h2>
                    <span class="close" onclick="closeModal('importModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="import-section">
                        <div class="upload-area" id="uploadArea">
                            <div class="upload-content">
                                <div class="upload-icon">üìÅ</div>
                                <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ Excel —Ñ–∞–π–ª —Å—é–¥–∞</h3>
                                <p>–∏–ª–∏</p>
                                <button class="btn btn-info" onclick="document.getElementById('excelFile').click()">
                                    –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª
                                </button>
                                <input type="file" id="excelFile" accept=".xlsx" style="display: none;" onchange="handleFileSelect(event)">
                                <div class="file-info">
                                    <small>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã .xlsx</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="import-preview" id="importPreview" style="display: none;">
                            <h3>üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</h3>
                            <div class="preview-info">
                                <div class="form-group">
                                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è:</label>
                                    <input type="text" id="importTaskTitle" placeholder="–ë—É–¥–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–æ –∏–∑ A2">
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>‚Ññ –ó–∞–¥–∞–Ω–∏—è:</label>
                                        <input type="text" id="importTaskNumber" readonly style="background: #f8f9fa;">
                                        <small style="color: #6c757d;">–ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</small>
                                    </div>
                                    <div class="form-group">
                                        <label>‚Ññ –ó–∞–∫–∞–∑–∞:</label>
                                        <input type="text" id="importOrderNumber" placeholder="2024/001" pattern="[0-9]{4}/[0-9]{3}" maxlength="8" oninput="formatOrderNumber(this)">
                                        <small style="color: #6c757d;">–§–æ—Ä–º–∞—Ç: –ì–ì–ì–ì/–ù–ù–ù (–≥–æ–¥/–Ω–æ–º–µ—Ä)</small>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</label>
                                        <select id="importPriority">
                                            <option value="normal">–ù–æ—Ä–º–∞–ª—å–Ω—ã–π</option>
                                            <option value="low">–ù–∏–∑–∫–∏–π</option>
                                            <option value="important">–í–∞–∂–Ω—ã–π</option>
                                            <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>–¢–∏–ø –∑–∞–¥–∞–Ω–∏—è:</label>
                                        <select id="importTaskType">
                                            <option value="picking" selected>–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è</option>
                                            <option value="shipment">–û—Ç–≥—Ä—É–∑–∫–∞</option>
                                            <option value="writeoff">–°–ø–∏—Å–∞–Ω–∏–µ</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="positions-preview">
                                <h4>üì¶ –ü–æ–∑–∏—Ü–∏–∏ –∏–∑ Excel —Ñ–∞–π–ª–∞:</h4>
                                <div class="positions-table-container">
                                    <table class="positions-table">
                                        <thead>
                                            <tr>
                                                <th>‚Ññ</th>
                                                <th>–û–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ</th>
                                                <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
                                                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                                <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                                            </tr>
                                        </thead>
                                        <tbody id="importPositionsBody">
                                            <!-- –ü–æ–∑–∏—Ü–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('importModal')">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-success" id="createFromImportBtn" onclick="createTaskFromImport()" style="display: none;">
                        ‚úÖ –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ
                    </button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç—á–µ—Ç–∞ –ø–æ –∑–∞–¥–∞–Ω–∏—é -->
        <div id="reportModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2>üìä –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∑–∞–¥–∞–Ω–∏—é</h2>
                    <span class="close" onclick="closeModal('reportModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <div id="taskReport">
                        <!-- –û—Ç—á–µ—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('reportModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                    <button class="btn btn-info" onclick="exportReport()">üìÑ –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–µ–º–∫–∏ -->
        <div id="receivingModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2>üì¶ –ü—Ä–∏–µ–º–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤</h2>
                    <span class="close" onclick="closeModal('receivingModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø—Ä–∏–µ–º–∫–∏ -->
                    <div class="receiving-filters" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <div class="filter-group">
                            <label>üìÖ –î–∞—Ç–∞ –ø—Ä–∏–µ–º–∫–∏:</label>
                            <input type="date" id="receivingDateFilter" onchange="filterReceivingItems()">
                        </div>
                        <div class="filter-group">
                            <label>üìã –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞:</label>
                            <input type="text" id="receivingOrderFilter" placeholder="2024/001" onkeyup="filterReceivingItems()">
                        </div>
                        <div class="filter-group">
                            <label>üìä –°—Ç–∞—Ç—É—Å –≤ –ù–ü:</label>
                            <select id="receivingStatusFilter" onchange="filterReceivingItems()">
                                <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                                <option value="pending">–û–∂–∏–¥–∞–µ—Ç</option>
                                <option value="approved">–û–¥–æ–±—Ä–µ–Ω–æ</option>
                                <option value="rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>üîç –ü–æ–∏—Å–∫:</label>
                            <input type="text" id="receivingSearchFilter" placeholder="–ü–æ–∏—Å–∫ –ø–æ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—é, –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—é..." onkeyup="filterReceivingItems()">
                        </div>
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏–µ–º–∫–∏ -->
                    <div style="margin: 20px 0;">
                        <button class="btn btn-success" onclick="openAddReceivingItemModal()">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏–µ–º–∫–∏
                        </button>
                    </div>
                    
                    <!-- –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–µ–º–∫–∏ -->
                    <div class="table-container">
                        <table class="tasks-table" id="receivingTable">
                            <thead>
                                <tr>
                                    <th class="sortable" data-sort="date" onclick="sortReceivingTable('date')">
                                        –î–∞—Ç–∞ <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="sortable" data-sort="orderNumber" onclick="sortReceivingTable('orderNumber')">
                                        ‚Ññ –ó–∞–∫–∞–∑–∞ <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="sortable" data-sort="designation" onclick="sortReceivingTable('designation')">
                                        –û–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="sortable" data-sort="name" onclick="sortReceivingTable('name')">
                                        –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="sortable" data-sort="quantity" onclick="sortReceivingTable('quantity')">
                                        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="sortable" data-sort="routeCard" onclick="sortReceivingTable('routeCard')">
                                        ‚Ññ –ú–∞—Ä—à—Ä—É—Ç–Ω–æ–π –∫–∞—Ä—Ç—ã <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="sortable" data-sort="npStatus" onclick="sortReceivingTable('npStatus')">
                                        –°—Ç–∞—Ç—É—Å –≤ –ù–ü <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="receivingTableBody">
                                <!-- –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–µ–º–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('receivingModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                    <button class="btn btn-warning" onclick="exportReceivingReport()">üìë –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏–µ–º–∫–∏ -->
        <div id="addReceivingItemModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏–µ–º–∫–∏</h2>
                    <span class="close" onclick="closeModal('addReceivingItemModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="addReceivingItemForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>–î–∞—Ç–∞ –ø—Ä–∏–µ–º–∫–∏ *</label>
                                <input type="date" id="receivingDate" required>
                            </div>
                            <div class="form-group">
                                <label>‚Ññ –ó–∞–∫–∞–∑–∞ *</label>
                                <input type="text" id="receivingOrderNumber" required placeholder="2024/001" pattern="[0-9]{4}/[0-9]{3}" maxlength="8" oninput="formatOrderNumber(this)">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>–û–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ *</label>
                                <input type="text" id="receivingDesignation" required placeholder="–ù–ó.–ö–®.050.16.01.01–ú.100">
                            </div>
                            <div class="form-group">
                                <label>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ *</label>
                                <input type="text" id="receivingName" required placeholder="–°–µ–¥–ª–æ –∫–ª–∞–ø–∞–Ω–∞">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ *</label>
                                <input type="number" id="receivingQuantity" required min="1" placeholder="10">
                            </div>
                            <div class="form-group">
                                <label>‚Ññ –ú–∞—Ä—à—Ä—É—Ç–Ω–æ–π –∫–∞—Ä—Ç—ã</label>
                                <input type="text" id="receivingRouteCard" placeholder="–ú–ö-2024-001">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>–°—Ç–∞—Ç—É—Å –≤ –ù–ü</label>
                            <select id="receivingNpStatus">
                                <option value="pending">–û–∂–∏–¥–∞–µ—Ç</option>
                                <option value="approved">–û–¥–æ–±—Ä–µ–Ω–æ</option>
                                <option value="rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('addReceivingItemModal')">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-success" onclick="addReceivingItem()">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="tasks-manager.js"></script>
</body>
</html> 